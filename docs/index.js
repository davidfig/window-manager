!function(){"use strict";function t(t,e){return t(e={exports:{}},e.exports),e.exports}var e=t((function(t){!function(e){var i=/^\s+/,s=/\s+$/,n=0,o=e.round,h=e.min,r=e.max,a=e.random;function l(t,a){if(a=a||{},(t=t||"")instanceof l)return t;if(!(this instanceof l))return new l(t,a);var c=function(t){var n={r:0,g:0,b:0},o=1,a=null,l=null,c=null,d=!1,p=!1;"string"==typeof t&&(t=function(t){t=t.replace(i,"").replace(s,"").toLowerCase();var e,n=!1;if(A[t])t=A[t],n=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};if(e=I.rgb.exec(t))return{r:e[1],g:e[2],b:e[3]};if(e=I.rgba.exec(t))return{r:e[1],g:e[2],b:e[3],a:e[4]};if(e=I.hsl.exec(t))return{h:e[1],s:e[2],l:e[3]};if(e=I.hsla.exec(t))return{h:e[1],s:e[2],l:e[3],a:e[4]};if(e=I.hsv.exec(t))return{h:e[1],s:e[2],v:e[3]};if(e=I.hsva.exec(t))return{h:e[1],s:e[2],v:e[3],a:e[4]};if(e=I.hex8.exec(t))return{r:H(e[1]),g:H(e[2]),b:H(e[3]),a:F(e[4]),format:n?"name":"hex8"};if(e=I.hex6.exec(t))return{r:H(e[1]),g:H(e[2]),b:H(e[3]),format:n?"name":"hex"};if(e=I.hex4.exec(t))return{r:H(e[1]+""+e[1]),g:H(e[2]+""+e[2]),b:H(e[3]+""+e[3]),a:F(e[4]+""+e[4]),format:n?"name":"hex8"};if(e=I.hex3.exec(t))return{r:H(e[1]+""+e[1]),g:H(e[2]+""+e[2]),b:H(e[3]+""+e[3]),format:n?"name":"hex"};return!1}(t));"object"==typeof t&&(K(t.r)&&K(t.g)&&K(t.b)?(u=t.r,f=t.g,m=t.b,n={r:255*L(u,255),g:255*L(f,255),b:255*L(m,255)},d=!0,p="%"===String(t.r).substr(-1)?"prgb":"rgb"):K(t.h)&&K(t.s)&&K(t.v)?(a=O(t.s),l=O(t.v),n=function(t,i,s){t=6*L(t,360),i=L(i,100),s=L(s,100);var n=e.floor(t),o=t-n,h=s*(1-i),r=s*(1-o*i),a=s*(1-(1-o)*i),l=n%6;return{r:255*[s,r,h,h,a,s][l],g:255*[a,s,s,r,h,h][l],b:255*[h,h,a,s,s,r][l]}}(t.h,a,l),d=!0,p="hsv"):K(t.h)&&K(t.s)&&K(t.l)&&(a=O(t.s),c=O(t.l),n=function(t,e,i){var s,n,o;function h(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}if(t=L(t,360),e=L(e,100),i=L(i,100),0===e)s=n=o=i;else{var r=i<.5?i*(1+e):i+e-i*e,a=2*i-r;s=h(a,r,t+1/3),n=h(a,r,t),o=h(a,r,t-1/3)}return{r:255*s,g:255*n,b:255*o}}(t.h,a,c),d=!0,p="hsl"),t.hasOwnProperty("a")&&(o=t.a));var u,f,m;return o=z(o),{ok:d,format:t.format||p,r:h(255,r(n.r,0)),g:h(255,r(n.g,0)),b:h(255,r(n.b,0)),a:o}}(t);this._originalInput=t,this._r=c.r,this._g=c.g,this._b=c.b,this._a=c.a,this._roundA=o(100*this._a)/100,this._format=a.format||c.format,this._gradientType=a.gradientType,this._r<1&&(this._r=o(this._r)),this._g<1&&(this._g=o(this._g)),this._b<1&&(this._b=o(this._b)),this._ok=c.ok,this._tc_id=n++}function c(t,e,i){t=L(t,255),e=L(e,255),i=L(i,255);var s,n,o=r(t,e,i),a=h(t,e,i),l=(o+a)/2;if(o==a)s=n=0;else{var c=o-a;switch(n=l>.5?c/(2-o-a):c/(o+a),o){case t:s=(e-i)/c+(e<i?6:0);break;case e:s=(i-t)/c+2;break;case i:s=(t-e)/c+4}s/=6}return{h:s,s:n,l:l}}function d(t,e,i){t=L(t,255),e=L(e,255),i=L(i,255);var s,n,o=r(t,e,i),a=h(t,e,i),l=o,c=o-a;if(n=0===o?0:c/o,o==a)s=0;else{switch(o){case t:s=(e-i)/c+(e<i?6:0);break;case e:s=(i-t)/c+2;break;case i:s=(t-e)/c+4}s/=6}return{h:s,s:n,v:l}}function p(t,e,i,s){var n=[P(o(t).toString(16)),P(o(e).toString(16)),P(o(i).toString(16))];return s&&n[0].charAt(0)==n[0].charAt(1)&&n[1].charAt(0)==n[1].charAt(1)&&n[2].charAt(0)==n[2].charAt(1)?n[0].charAt(0)+n[1].charAt(0)+n[2].charAt(0):n.join("")}function u(t,e,i,s){return[P(W(s)),P(o(t).toString(16)),P(o(e).toString(16)),P(o(i).toString(16))].join("")}function f(t,e){e=0===e?0:e||10;var i=l(t).toHsl();return i.s-=e/100,i.s=E(i.s),l(i)}function m(t,e){e=0===e?0:e||10;var i=l(t).toHsl();return i.s+=e/100,i.s=E(i.s),l(i)}function g(t){return l(t).desaturate(100)}function w(t,e){e=0===e?0:e||10;var i=l(t).toHsl();return i.l+=e/100,i.l=E(i.l),l(i)}function v(t,e){e=0===e?0:e||10;var i=l(t).toRgb();return i.r=r(0,h(255,i.r-o(-e/100*255))),i.g=r(0,h(255,i.g-o(-e/100*255))),i.b=r(0,h(255,i.b-o(-e/100*255))),l(i)}function b(t,e){e=0===e?0:e||10;var i=l(t).toHsl();return i.l-=e/100,i.l=E(i.l),l(i)}function y(t,e){var i=l(t).toHsl(),s=(i.h+e)%360;return i.h=s<0?360+s:s,l(i)}function x(t){var e=l(t).toHsl();return e.h=(e.h+180)%360,l(e)}function _(t){var e=l(t).toHsl(),i=e.h;return[l(t),l({h:(i+120)%360,s:e.s,l:e.l}),l({h:(i+240)%360,s:e.s,l:e.l})]}function k(t){var e=l(t).toHsl(),i=e.h;return[l(t),l({h:(i+90)%360,s:e.s,l:e.l}),l({h:(i+180)%360,s:e.s,l:e.l}),l({h:(i+270)%360,s:e.s,l:e.l})]}function C(t){var e=l(t).toHsl(),i=e.h;return[l(t),l({h:(i+72)%360,s:e.s,l:e.l}),l({h:(i+216)%360,s:e.s,l:e.l})]}function S(t,e,i){e=e||6,i=i||30;var s=l(t).toHsl(),n=360/i,o=[l(t)];for(s.h=(s.h-(n*e>>1)+720)%360;--e;)s.h=(s.h+n)%360,o.push(l(s));return o}function T(t,e){e=e||6;for(var i=l(t).toHsv(),s=i.h,n=i.s,o=i.v,h=[],r=1/e;e--;)h.push(l({h:s,s:n,v:o})),o=(o+r)%1;return h}l.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},getLuminance:function(){var t,i,s,n=this.toRgb();return t=n.r/255,i=n.g/255,s=n.b/255,.2126*(t<=.03928?t/12.92:e.pow((t+.055)/1.055,2.4))+.7152*(i<=.03928?i/12.92:e.pow((i+.055)/1.055,2.4))+.0722*(s<=.03928?s/12.92:e.pow((s+.055)/1.055,2.4))},setAlpha:function(t){return this._a=z(t),this._roundA=o(100*this._a)/100,this},toHsv:function(){var t=d(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=d(this._r,this._g,this._b),e=o(360*t.h),i=o(100*t.s),s=o(100*t.v);return 1==this._a?"hsv("+e+", "+i+"%, "+s+"%)":"hsva("+e+", "+i+"%, "+s+"%, "+this._roundA+")"},toHsl:function(){var t=c(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=c(this._r,this._g,this._b),e=o(360*t.h),i=o(100*t.s),s=o(100*t.l);return 1==this._a?"hsl("+e+", "+i+"%, "+s+"%)":"hsla("+e+", "+i+"%, "+s+"%, "+this._roundA+")"},toHex:function(t){return p(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(t){return function(t,e,i,s,n){var h=[P(o(t).toString(16)),P(o(e).toString(16)),P(o(i).toString(16)),P(W(s))];if(n&&h[0].charAt(0)==h[0].charAt(1)&&h[1].charAt(0)==h[1].charAt(1)&&h[2].charAt(0)==h[2].charAt(1)&&h[3].charAt(0)==h[3].charAt(1))return h[0].charAt(0)+h[1].charAt(0)+h[2].charAt(0)+h[3].charAt(0);return h.join("")}(this._r,this._g,this._b,this._a,t)},toHex8String:function(t){return"#"+this.toHex8(t)},toRgb:function(){return{r:o(this._r),g:o(this._g),b:o(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+o(this._r)+", "+o(this._g)+", "+o(this._b)+")":"rgba("+o(this._r)+", "+o(this._g)+", "+o(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:o(100*L(this._r,255))+"%",g:o(100*L(this._g,255))+"%",b:o(100*L(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+o(100*L(this._r,255))+"%, "+o(100*L(this._g,255))+"%, "+o(100*L(this._b,255))+"%)":"rgba("+o(100*L(this._r,255))+"%, "+o(100*L(this._g,255))+"%, "+o(100*L(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(M[p(this._r,this._g,this._b,!0)]||!1)},toFilter:function(t){var e="#"+u(this._r,this._g,this._b,this._a),i=e,s=this._gradientType?"GradientType = 1, ":"";if(t){var n=l(t);i="#"+u(n._r,n._g,n._b,n._a)}return"progid:DXImageTransform.Microsoft.gradient("+s+"startColorstr="+e+",endColorstr="+i+")"},toString:function(t){var e=!!t;t=t||this._format;var i=!1,s=this._a<1&&this._a>=0;return e||!s||"hex"!==t&&"hex6"!==t&&"hex3"!==t&&"hex4"!==t&&"hex8"!==t&&"name"!==t?("rgb"===t&&(i=this.toRgbString()),"prgb"===t&&(i=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(i=this.toHexString()),"hex3"===t&&(i=this.toHexString(!0)),"hex4"===t&&(i=this.toHex8String(!0)),"hex8"===t&&(i=this.toHex8String()),"name"===t&&(i=this.toName()),"hsl"===t&&(i=this.toHslString()),"hsv"===t&&(i=this.toHsvString()),i||this.toHexString()):"name"===t&&0===this._a?this.toName():this.toRgbString()},clone:function(){return l(this.toString())},_applyModification:function(t,e){var i=t.apply(null,[this].concat([].slice.call(e)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(w,arguments)},brighten:function(){return this._applyModification(v,arguments)},darken:function(){return this._applyModification(b,arguments)},desaturate:function(){return this._applyModification(f,arguments)},saturate:function(){return this._applyModification(m,arguments)},greyscale:function(){return this._applyModification(g,arguments)},spin:function(){return this._applyModification(y,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(S,arguments)},complement:function(){return this._applyCombination(x,arguments)},monochromatic:function(){return this._applyCombination(T,arguments)},splitcomplement:function(){return this._applyCombination(C,arguments)},triad:function(){return this._applyCombination(_,arguments)},tetrad:function(){return this._applyCombination(k,arguments)}},l.fromRatio=function(t,e){if("object"==typeof t){var i={};for(var s in t)t.hasOwnProperty(s)&&(i[s]="a"===s?t[s]:O(t[s]));t=i}return l(t,e)},l.equals=function(t,e){return!(!t||!e)&&l(t).toRgbString()==l(e).toRgbString()},l.random=function(){return l.fromRatio({r:a(),g:a(),b:a()})},l.mix=function(t,e,i){i=0===i?0:i||50;var s=l(t).toRgb(),n=l(e).toRgb(),o=i/100;return l({r:(n.r-s.r)*o+s.r,g:(n.g-s.g)*o+s.g,b:(n.b-s.b)*o+s.b,a:(n.a-s.a)*o+s.a})},l.readability=function(t,i){var s=l(t),n=l(i);return(e.max(s.getLuminance(),n.getLuminance())+.05)/(e.min(s.getLuminance(),n.getLuminance())+.05)},l.isReadable=function(t,e,i){var s,n,o=l.readability(t,e);switch(n=!1,(s=function(t){var e,i;e=((t=t||{level:"AA",size:"small"}).level||"AA").toUpperCase(),i=(t.size||"small").toLowerCase(),"AA"!==e&&"AAA"!==e&&(e="AA");"small"!==i&&"large"!==i&&(i="small");return{level:e,size:i}}(i)).level+s.size){case"AAsmall":case"AAAlarge":n=o>=4.5;break;case"AAlarge":n=o>=3;break;case"AAAsmall":n=o>=7}return n},l.mostReadable=function(t,e,i){var s,n,o,h,r=null,a=0;n=(i=i||{}).includeFallbackColors,o=i.level,h=i.size;for(var c=0;c<e.length;c++)(s=l.readability(t,e[c]))>a&&(a=s,r=l(e[c]));return l.isReadable(t,r,{level:o,size:h})||!n?r:(i.includeFallbackColors=!1,l.mostReadable(t,["#fff","#000"],i))};var A=l.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},M=l.hexNames=function(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[t[i]]=i);return e}(A);function z(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function L(t,i){(function(t){return"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)})(t)&&(t="100%");var s=function(t){return"string"==typeof t&&-1!=t.indexOf("%")}(t);return t=h(i,r(0,parseFloat(t))),s&&(t=parseInt(t*i,10)/100),e.abs(t-i)<1e-6?1:t%i/parseFloat(i)}function E(t){return h(1,r(0,t))}function H(t){return parseInt(t,16)}function P(t){return 1==t.length?"0"+t:""+t}function O(t){return t<=1&&(t=100*t+"%"),t}function W(t){return e.round(255*parseFloat(t)).toString(16)}function F(t){return H(t)/255}var D,R,B,I=(R="[\\s|\\(]+("+(D="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+D+")[,|\\s]+("+D+")\\s*\\)?",B="[\\s|\\(]+("+D+")[,|\\s]+("+D+")[,|\\s]+("+D+")[,|\\s]+("+D+")\\s*\\)?",{CSS_UNIT:new RegExp(D),rgb:new RegExp("rgb"+R),rgba:new RegExp("rgba"+B),hsl:new RegExp("hsl"+R),hsla:new RegExp("hsla"+B),hsv:new RegExp("hsv"+R),hsva:new RegExp("hsva"+B),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function K(t){return!!I.CSS_UNIT.exec(t)}t.exports?t.exports=l:window.tinycolor=l}(Math)})),i=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}();var s={background:"rgba(0, 0, 0, 0.5)",color:"white"},n={padding:"0.1em 0.5em"},o={},h=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=e||{},this.tolerance=this.options.tolerance||1,this.FPS=this.options.FPS||60,this.meterWidth=this.options.meterWidth||100,this.meterHeight=this.options.meterHeight||25,this.meterLineHeight=this.options.meterLineHeight||4,this.div=document.createElement("div"),class t{constructor(e){(e=e||{}).side=e.side||"rightbottom",e.side.toLowerCase(),e.padding=e.padding||"7px",e.color=e.color||"white",e.background=e.background||"rgba(0,0,0,0.5)",this.div=document.createElement("div"),t.findParent(e.side).appendChild(this.div);for(let t in e)"parent"!==t&&"side"!==t&&(this.div.style[t]=e[t])}static findParent(t){const e=[];let i="yy-counter-";-1!==t.indexOf("left")?(i+="left-",e.left=0):(i+="right-",e.right=0),-1!==t.indexOf("top")?(i+="top",e.top=0):(i+="bottom",e.bottom=0);const s=document.getElementById(i);if(s)return s;const n=document.createElement("div");n.id=i,n.style.overflow="hidden",n.style.position="fixed",n.style.zIndex=1e4,n.style.pointerEvents="none",n.style.userSelect="none";for(let t in e)n.style[t]=e[t];return document.body.appendChild(n),n}log(){let t="";for(let e of arguments)t+="<div>"+e+"</div>";this.div.innerHTML=t}append(){let t=this.div.innerHTML;for(let e of arguments)t+="<div>"+e+"</div>";this.div.innerHTML=t}}.findParent(this.options.side||"bottom-right").appendChild(this.div),this.style(this.div,s,this.options.styles),this.divFPS(),this.meter=void 0===this.options.meter||this.options.meter,this.lastTime=0,this.frameNumber=0,this.lastUpdate=0,this.lastFPS="--"}return i(t,[{key:"remove",value:function(){this.div.remove()}},{key:"style",value:function(t,e,i){for(var s in e)t.style[s]=e[s];if(i)for(var n in i)t.style[n]=i[n]}},{key:"divFPS",value:function(){var t=this.div,e=this.options,i=document.createElement("div");t.appendChild(i),this.fpsSpan=document.createElement("span"),i.appendChild(this.fpsSpan);var s=document.createElement("span");i.appendChild(s),s.innerText=void 0!==e.text?e.text:" FPS",this.style(t,n,e.stylesFPS)}},{key:"divMeter",value:function(){var t=this.div,e=this.options;this.meterCanvas?this.meterCanvas.style.display="block":(this.meterCanvas=document.createElement("canvas"),t.appendChild(this.meterCanvas),this.meterCanvas.width=this.meterWidth,this.meterCanvas.height=this.meterHeight,this.meterCanvas.style.width=t.width+"px",this.meterCanvas.style.height=t.height+"px",this.style(this.meterCanvas,o,e.stylesMeter))}},{key:"frame",value:function(){this.frameNumber++;var t=performance.now()-this.lastTime;t>500&&(0!==this.lastTime&&(this.lastFPS=Math.floor(this.frameNumber/(t/1e3)),this.lastFPS>=this.FPS-this.tolerance&&this.lastFPS<=this.FPS+this.tolerance&&(this.lastFPS=this.FPS)),this.lastTime=performance.now(),this.frameNumber=0),this.fpsSpan.innerText=this.lastFPS,this.meterCanvas&&"--"!==this.lastFPS&&this.meterUpdate(this.lastFPS/this.FPS)}},{key:"meterUpdate",value:function(t){var i=this.meterCanvas.getContext("2d"),s=i.getImageData(0,0,this.meterCanvas.width,this.meterCanvas.height);i.putImageData(s,-1,0),i.clearRect(this.meterCanvas.width-1,0,1,this.meterCanvas.height),i.fillStyle=t<.5?e.mix("#ff0000","0xffa500",200*t).toHexString():e.mix("#ffa500","#00ff00",200*(t-.5)).toHexString();var n=(this.meterCanvas.height-this.meterLineHeight)*(1-t);i.fillRect(this.meterCanvas.width-1,n,1,this.meterLineHeight)}},{key:"side",value:function(t){t.side?(t.side=t.side.toLowerCase(),-1!==t.side.indexOf("left")?(s.left=0,delete s.right):(s.right=0,delete s.left),-1!==t.side.indexOf("top")?(s.top=0,delete s.bottom):(s.bottom=0,delete s.top)):(s.right=0,s.bottom=0)}},{key:"fps",get:function(){return this.FPS},set:function(t){this.FPS=t}},{key:"meter",get:function(){return this._meter},set:function(t){t?this.divMeter():this.meterCanvas&&(this.meterCanvas.style.display="none")}}]),t}();function r(t={}){const e=document.createElement(t.type||"div");return t.styles&&Object.assign(e.style,t.styles),t.className&&(e.className=t.className),t.html&&(e.innerHTML=t.html),t.parent&&t.parent.appendChild(e),e}var a=t((function(t){var e=Object.prototype.hasOwnProperty,i="~";function s(){}function n(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function o(t,e,s,o,h){if("function"!=typeof s)throw new TypeError("The listener must be a function");var r=new n(s,o||t,h),a=i?i+e:e;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],r]:t._events[a].push(r):(t._events[a]=r,t._eventsCount++),t}function h(t,e){0==--t._eventsCount?t._events=new s:delete t._events[e]}function r(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(i=!1)),r.prototype.eventNames=function(){var t,s,n=[];if(0===this._eventsCount)return n;for(s in t=this._events)e.call(t,s)&&n.push(i?s.slice(1):s);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},r.prototype.listeners=function(t){var e=i?i+t:t,s=this._events[e];if(!s)return[];if(s.fn)return[s.fn];for(var n=0,o=s.length,h=new Array(o);n<o;n++)h[n]=s[n].fn;return h},r.prototype.listenerCount=function(t){var e=i?i+t:t,s=this._events[e];return s?s.fn?1:s.length:0},r.prototype.emit=function(t,e,s,n,o,h){var r=i?i+t:t;if(!this._events[r])return!1;var a,l,c=this._events[r],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,s),!0;case 4:return c.fn.call(c.context,e,s,n),!0;case 5:return c.fn.call(c.context,e,s,n,o),!0;case 6:return c.fn.call(c.context,e,s,n,o,h),!0}for(l=1,a=new Array(d-1);l<d;l++)a[l-1]=arguments[l];c.fn.apply(c.context,a)}else{var p,u=c.length;for(l=0;l<u;l++)switch(c[l].once&&this.removeListener(t,c[l].fn,void 0,!0),d){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,e);break;case 3:c[l].fn.call(c[l].context,e,s);break;case 4:c[l].fn.call(c[l].context,e,s,n);break;default:if(!a)for(p=1,a=new Array(d-1);p<d;p++)a[p-1]=arguments[p];c[l].fn.apply(c[l].context,a)}}return!0},r.prototype.on=function(t,e,i){return o(this,t,e,i,!1)},r.prototype.once=function(t,e,i){return o(this,t,e,i,!0)},r.prototype.removeListener=function(t,e,s,n){var o=i?i+t:t;if(!this._events[o])return this;if(!e)return h(this,o),this;var r=this._events[o];if(r.fn)r.fn!==e||n&&!r.once||s&&r.context!==s||h(this,o);else{for(var a=0,l=[],c=r.length;a<c;a++)(r[a].fn!==e||n&&!r[a].once||s&&r[a].context!==s)&&l.push(r[a]);l.length?this._events[o]=1===l.length?l[0]:l:h(this,o)}return this},r.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&h(this,e)):(this._events=new s,this._eventsCount=0),this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prefixed=i,r.EventEmitter=r,t.exports=r}));const l={threshold:10,clicked:!0,doubleClicked:!1,doubleClickedTime:300,longClicked:!1,longClickedTime:500,capture:!1,clickDown:!1};function c(t,e,i){return new d(t,e,i)}class d{constructor(t,e,i){"string"!=typeof t||(t=document.querySelector(t))?(this.options=Object.assign({},l,i),this.events={mousedown:t=>this.mousedown(t),mouseup:t=>this.mouseup(t),mousemove:t=>this.mousemove(t),touchstart:t=>this.touchstart(t),touchmove:t=>this.touchmove(t),touchcancel:t=>this.cancel(t),touchend:t=>this.touchend(t)},t.addEventListener("mousedown",this.events.mousedown,{capture:this.options.capture}),t.addEventListener("mouseup",this.events.mouseup,{capture:this.options.capture}),t.addEventListener("mousemove",this.events.mousemove,{capture:this.options.capture}),t.addEventListener("touchstart",this.events.touchstart,{passive:!0,capture:this.options.capture}),t.addEventListener("touchmove",this.events.touchmove,{passive:!0,capture:this.options.capture}),t.addEventListener("touchcancel",this.events.touchcancel,{capture:this.options.capture}),t.addEventListener("touchend",this.events.touchend,{capture:this.options.capture}),this.element=t,this.callback=e):console.warn(`Unknown element: document.querySelector(${t}) in clicked()`)}destroy(){this.element.removeEventListener("mousedown",this.events.mousedown),this.element.removeEventListener("mouseup",this.events.mouseup),this.element.removeEventListener("mousemove",this.events.mousemove),this.element.removeEventListener("touchstart",this.events.touchstart,{passive:!0}),this.element.removeEventListener("touchmove",this.events.touchmove,{passive:!0}),this.element.removeEventListener("touchcancel",this.events.touchcancel),this.element.removeEventListener("touchend",this.events.touchend)}touchstart(t){!0===this.down?this.cancel():1===t.touches.length&&this.handleDown(t.changedTouches[0].screenX,t.changedTouches[0].screenY)}pastThreshold(t,e){return Math.abs(this.lastX-t)>this.options.threshold||Math.abs(this.lastY-e)>this.options.threshold}touchmove(t){if(this.down)if(1!==t.touches.length)this.cancel();else{const e=t.changedTouches[0].screenX,i=t.changedTouches[0].screenY;this.pastThreshold(e,i)&&this.cancel()}}cancel(){this.down=!1,this.doubleClickedTimeout&&(clearTimeout(this.doubleClickedTimeout),this.doubleClickedTimeout=null),this.longClickedTimeout&&(clearTimeout(this.longClickedTimeout),this.longClickedTimeout=null)}touchend(t){this.down&&(t.preventDefault(),this.handleClicks(t,t.pointerId))}handleClicks(t){this.options.doubleClicked?this.doubleClickedTimeout=setTimeout(()=>this.doubleClickedCancel(t),this.options.doubleClickedTime):this.options.clicked&&this.callback({event:t,type:"clicked"}),this.longClickedTimeout&&(clearTimeout(this.longClickedTimeout),this.longClickedTimeout=null),this.down=!1}handleDown(t,e,i){this.doubleClickedTimeout?this.pastThreshold(e,i)?(this.options.clicked&&this.callback({event:t,type:"clicked"}),this.cancel()):(this.callback({event:t,type:"double-clicked"}),this.cancel()):(this.lastX=e,this.lastY=i,this.down=!0,this.options.longClicked&&(this.longClickedTimeout=setTimeout(()=>this.longClicked(t),this.options.longClickedTime)),this.options.clickDown&&this.callback({event:t,type:"click-down"}))}longClicked(t){this.longClikedTimeout=null,this.down=!1,this.callback({event:t,type:"long-clicked"})}doubleClickedCancel(t){this.doubleClickedTimeout=null,this.options.clicked&&this.callback({event:t,type:"double-clicked"})}mousedown(t){!0===this.down?this.down=!1:this.handleDown(t,t.screenX,t.screenY)}mousemove(t){if(this.down){const e=t.screenX,i=t.screenY;this.pastThreshold(e,i)&&this.cancel()}}mouseup(t){this.down&&(t.preventDefault(),this.handleClicks(t))}}const p={ApplicationContainerStyle:{"z-index":999999,position:"absolute",top:0,left:0,"user-select":"none","font-size":"0.85em"},ApplicationMenuStyle:{display:"flex",position:"relative","flex-direction":"row",color:"black",backgroundColor:"rgb(230,230,230)",width:"100vw",border:"none","box-shadow":"unset",outline:"none"},ApplicationMenuRowStyle:{padding:"0.25em 0.5em",margin:0,"line-height":"1em"},MenuStyle:{"flex-direction":"column",position:"absolute","user-select":"none",color:"black","z-index":999999,backgroundColor:"white",border:"1px solid rgba(0,0,0,0.5)",boxShadow:"1px 3px 3px rgba(0,0,0,0.25)"},RowStyle:{display:"flex",padding:"0.25em 1.5em 0.25em","line-height":"1.5em"},AcceleratorStyle:{opacity:.5},SeparatorStyle:{"border-bottom":"1px solid rgba(0,0,0,0.1)",margin:"0.5em 0"},AcceleratorKeyStyle:{"text-decoration":"underline","text-decoration-color":"rgba(0,0,0,0.5)"},MinimumColumnWidth:20,SelectedBackgroundStyle:"rgba(0,0,0,0.1)",Overlap:5,SubmenuOpenDelay:500};const u=new class{init(){this.initialized||(this.menuKeys={},this.keys={},document.body.addEventListener("keydown",t=>this._keydown(t)),document.body.addEventListener("keyup",t=>this._keyup(t)),this.initialized=!0)}clearMenuKeys(){this.menuKeys={}}clearKeys(){this.keys={}}registerMenuShortcut(t,e){if(t){const i=(e.menu.applicationMenu?"alt+":"")+t;this.menuKeys[this._prepareKey(i)]=t=>{e.handleClick(t),t.stopPropagation(),t.preventDefault()}}}registerMenuSpecial(t){this.menuKeys.escape=()=>t.closeAll(),this.menuKeys.enter=e=>t.enter(e),this.menuKeys.space=e=>t.enter(e),this.menuKeys.arrowright=e=>t.move(e,"right"),this.menuKeys.arrowleft=e=>t.move(e,"left"),this.menuKeys.arrowup=e=>t.move(e,"up"),this.menuKeys.arrowdown=e=>t.move(e,"down")}registerAlt(t,e){this.alt={pressed:t,released:e}}unregisterMenuShortcuts(){this.menuKeys={}}_prepareKey(t){const e=[];let i;i=(t+="").length>1&&-1!==t.indexOf("|")?t.split("|"):[t];for(let t of i){let i="",s=[];if(t=t.toLowerCase().replace(" ",""),-1!==t.indexOf("+")){const e=t.split("+");for(let t=0;t<e.length-1;t++){let i=e[t];i=i.replace("commandorcontrol","ctrl"),i=i.replace("command","ctrl"),i=i.replace("control","ctrl"),s.push(i)}s=s.sort((t,e)=>t[0]>e[0]?1:t[0]<e[0]?-1:0);for(let t of s)i+=t+"+";i+=e[e.length-1]}else i=t;e.push(i)}return e}prettifyKey(t){let e="";const i=this._prepareKey(t);for(let t=0;t<i.length;t++){const s=i[t];if(-1!==s.indexOf("+")){const t=s.toLowerCase().split("+");for(let i=0;i<t.length-1;i++){let s=t[i];e+=s[0].toUpperCase()+s.substr(1)+"+"}e+=t[t.length-1].toUpperCase()}else e=s.toUpperCase();t!==i.length-1&&(e+=" or ")}return e}register(t,e){const i=this._prepareKey(t);for(let t of i)this.keys[t]=t=>{e(t),t.preventDefault(),t.stopPropagation()}}_keyup(t){!this.alt||"AltLeft"!==t.code&&"AltRight"!==t.code||(this.alt.released(),this.alt.isPressed=!1)}_keydown(t){!this.alt||this.alt.isPressed||"AltLeft"!==t.code&&"AltRight"!==t.code||(this.alt.pressed(),this.alt.isPressed=!0,t.preventDefault());const e=[];t.altKey&&e.push("alt"),t.ctrlKey&&e.push("ctrl"),t.metaKey&&e.push("meta"),t.shiftKey&&e.push("shift");let i="";for(let t of e)i+=t+"+";let s=t.code.toLowerCase();s=s.replace("digit",""),s=s.replace("key",""),i+=s,this.menuKeys[i]?this.menuKeys[i](t):this.keys[i]&&this.keys[i](t)}};class f{constructor(t){t=t||{},this.styles=t.styles,this.div=r(),this.type=t.type,this.click=t.click,"separator"===this.type?this.applyConfig(p.SeparatorStyle):(this._checked=t.checked,this.createChecked(t.checked),this.text=t.label||"&nbsp;&nbsp;&nbsp;",this.createShortcut(),this.createAccelerator(t.accelerator),this.createSubmenu(t.submenu),t.submenu&&(this.submenu=t.submenu,this.submenu.applyConfig(p.MenuStyle)),this.applyConfig(p.RowStyle),this.div.addEventListener("mousedown",t=>this.handleClick(t)),this.div.addEventListener("touchstart",t=>this.handleClick(t)),this.div.addEventListener("mouseenter",()=>this.mouseenter()),this.div.addEventListener("mouseleave",()=>this.mouseleave()))}mouseenter(){this.submenu&&this.menu.showing===this||(this.div.style.backgroundColor=p.SelectedBackgroundStyle,!this.submenu||this.menu.applicationMenu&&!this.menu.showing||(this.submenuTimeout=setTimeout(()=>{this.submenuTimeout=null,this.submenu.show(this)},this.menu.applicationMenu?0:p.SubmenuOpenDelay)))}mouseleave(){this.submenu&&this.menu.showing===this||(this.submenuTimeout&&(clearTimeout(this.submenuTimeout),this.submenuTimeout=null),this.div.style.backgroundColor="transparent")}applyConfig(t){const e={};for(let i in t)e[i]=t[i];if(this.styles)for(let t in this.styles)e[t]=this.styles[t];for(let t in e)this.div.style[t]=e[t]}createChecked(t){this.check=r({parent:this.div,html:t?"&#10004;":""})}createShortcut(){if("separator"!==this.type){const t=this.text;this.label=r({parent:this.div});let e=r({parent:this.label,type:"span"});if(-1!==t.indexOf("&")){let i=0;do{const s=t[i];"&"===s?(i++,this.shortcutSpan=r({parent:this.label,type:"span",html:t[i],styles:p.AcceleratorKeyStyle}),e=r({parent:this.label,type:"span"})):e.innerHTML+=s,i++}while(i<t.length)}else this.label.innerHTML=t}}showShortcut(){this.shortcutSpan&&(this.shortcutSpan.style.textDecoration="underline")}hideShortcut(){this.shortcutSpan&&(this.shortcutSpan.style.textDecoration="none")}createAccelerator(t){this.accelerator=r({parent:this.div,html:t?u.prettifyKey(t):"",styles:p.AcceleratorStyle}),u&&u.register(t,t=>this.click(t))}createSubmenu(t){this.arrow=r({parent:this.div,html:t?"&#9658;":""})}closeAll(){let t=this.menu;for(u.unregisterMenuShortcuts();t&&!t.applicationMenu;)t.showing&&(t.showing.div.style.backgroundColor="transparent",t.showing=null),t.div.remove(),t=t.menu;t.showing&&(t.showing.div.style.background="transparent",t.showing=null,t.hideAccelerators())}handleClick(t){this.submenu?(this.submenuTimeout&&(clearTimeout(this.submenuTimeout),this.submenuTimeout=null),this.submenu.show(this),this.div.style.backgroundColor=p.SelectedBackgroundStyle,void 0!==t&&this.menu.applicationMenu&&document.activeElement!==this.menu.div&&this.menu.div.focus(),t&&t.preventDefault()):"checkbox"===this.type?(this.checked=!this.checked,this.closeAll()):this.closeAll(),this.click&&this.click(t,this)}get checked(){return this._checked}set checked(t){this._checked=t,this.check.innerHTML=this._checked?"&#10004;":""}}class m{constructor(t){u.init(),t=t||{},this.div=document.createElement("div"),this.styles=t.styles,this.children=[],this.applyConfig(p.MenuStyle),this.div.tabIndex=-1}append(t){t.submenu&&(t.submenu.menu=this),t.menu=this,this.div.appendChild(t.div),"separator"!==t.type&&this.children.push(t)}insert(t,e){t>=this.div.childNodes.length?this.append(e):(e.submenu&&(e.submenu.menu=this),e.menu=this,this.div.insertBefore(e.div,this.div.childNodes[t]),"separator"!==e.type&&this.children.splice(t,0,e))}hide(){let t=this.menu.showing;for(;t&&t.submenu;){t.div.style.backgroundColor="transparent",t.submenu.div.remove();let e=t.submenu.showing;e&&(t.submenu.showing.div.style.backgroundColor="transparent",t.submenu.showing=null),t=e}}show(t){if(u.unregisterMenuShortcuts(),this.menu&&this.menu.showing===t)this.hide(),this.menu.showing=null,this.div.remove(),this.menu.showAccelerators();else{this.menu&&(this.menu.showing&&-1!==this.menu.children.indexOf(t)&&this.hide(),this.menu.showing=t,this.menu.hideAccelerators());const e=t.div,i=this.menu.div;this.menu.applicationMenu?(this.div.style.left=e.offsetLeft+"px",this.div.style.top=e.offsetTop+e.offsetHeight+"px"):(this.div.style.left=i.offsetLeft+i.offsetWidth-p.Overlap+"px",this.div.style.top=i.offsetTop+e.offsetTop-p.Overlap+"px"),this.attached=t,this.showAccelerators(),m.application.appendChild(this.div);let s=0,n=0,o=0,h=0;for(let t of this.children)t.check.style.width="auto",t.label.style.width="auto",t.accelerator.style.width="auto",t.arrow.style.width="auto","checkbox"===t.type&&(h=p.MinimumColumnWidth),t.submenu&&(o=p.MinimumColumnWidth);for(let t of this.children){const e=2*t.label.offsetWidth;s=e>s?e:s;const i=t.accelerator.offsetWidth;n=i>n?i:n,t.submenu&&(o=t.arrow.offsetWidth)}for(let t of this.children)t.check.style.width=h+"px",t.label.style.width=s+"px",t.accelerator.style.width=n+"px",t.arrow.style.width=o+"px";this.div.offsetLeft+this.div.offsetWidth>window.innerWidth&&(this.div.style.left=window.innerWidth-this.div.offsetWidth+"px"),this.div.offsetTop+this.div.offsetHeight>window.innerHeight&&(this.div.style.top=window.innerHeight-this.div.offsetHeight+"px"),m.application.menu.div.focus()}}applyConfig(t){const e={};for(let i in t)e[i]=t[i];if(this.styles)for(let t in this.styles)e[t]=this.styles[t];for(let t in e)this.div.style[t]=e[t]}showAccelerators(){for(let t of this.children)if(t.showShortcut(),"separator"!==t.type){const e=t.text.indexOf("&");-1!==e&&u.registerMenuShortcut(t.text[e+1],t)}this.applicationMenu||u.registerMenuSpecial(this)}hideAccelerators(){for(let t of this.children)t.hideShortcut()}closeAll(){u.unregisterMenuShortcuts();let t=m.application.menu;if(t.showing){let e=t;for(;e.showing;)e=e.showing.submenu;for(;e&&!e.applicationMenu;)e.showing&&(e.showing.div.style.backgroundColor="transparent",e.showing=null),e.div.remove(),e=e.menu;e&&(e.showing.div.style.background="transparent",e.showing=null,e.hideAccelerators())}}moveChild(t){let e;if("left"===t){const t=this.selector.menu.menu;e=t.children.indexOf(t.showing),e--,e=e<0?t.children.length-1:e,t.children[e].handleClick()}else{let t=this.selector.menu.menu,i=t.showing;for(;!t.applicationMenu;)i.handleClick(),i.div.style.backgroundColor="transparent",t=t.menu,i=t.showing;e=t.children.indexOf(i),e++,e=e===t.children.length?0:e,t.children[e].handleClick()}this.selector=null}horizontalSelector(t,e){"right"===e?this.selector.submenu?(this.selector.handleClick(t),this.selector.submenu.selector=this.selector.submenu.children[0],this.selector.submenu.selector.div.style.backgroundColor=p.SelectedBackgroundStyle,this.selector=null):this.moveChild(e):"left"===e&&(this.selector.menu.menu.applicationMenu?this.moveChild(e):(this.selector.menu.attached.handleClick(t),this.selector.menu.menu.selector=this.selector.menu.attached,this.selector=null)),t.stopPropagation(),t.preventDefault()}move(t,e){if(this.selector){this.selector.div.style.backgroundColor="transparent";let i=this.children.indexOf(this.selector);if("down"===e)i++,i=i===this.children.length?0:i;else{if("up"!==e)return this.horizontalSelector(t,e);i--,i=i<0?this.children.length-1:i}this.selector=this.children[i]}else this.selector="up"===e?this.children[this.children.length-1]:this.children[0];this.selector&&(this.selector.div.style.backgroundColor=p.SelectedBackgroundStyle),t.preventDefault(),t.stopPropagation()}enter(t){this.selector&&(this.selector.handleClick(t),t.preventDefault(),t.stopPropagation())}get items(){return this.children}showApplicationAccelerators(){this.hideAccelerators(),u.registerAlt(()=>{this.showing||this.showAccelerators()},()=>{this.hideAccelerators()})}static get config(){return p}static getApplicationHeight(){return m.application?m.application.offsetHeight:0}static setApplicationMenu(t,e=document.body){u.clearMenuKeys(),m.application&&m.application.remove(),m.application=r({parent:e,styles:p.ApplicationContainerStyle}),m.application.menu=t,t.applyConfig(p.ApplicationMenuStyle);for(let e of t.children)e.applyConfig(p.ApplicationMenuRowStyle),e.arrow&&(e.arrow.style.display="none"),t.div.appendChild(e.div);m.application.appendChild(t.div),t.applicationMenu=!0,t.div.tabIndex=-1,t.div.addEventListener("focus",()=>{t.showing||t.div.blur()}),t.div.addEventListener("blur",()=>{t.showing&&t.closeAll()}),t.showApplicationAccelerators()}}class g extends a{constructor(t,e={}){super(),this.wm=t,this.options=e,this.id=void 0===this.options.id?g.id++:this.options.id,this._createWin(),this._createWinBox(),this._createTitlebar(),this._createContent(),this.options.resizable&&this._createResize(),this._createOverlay(),this._buildTransform(),this._listeners(),this.active=!1,this.maximized=!1,this._closed=!0,this._restore=null,this._moving=null,this._resizing=null,this._attachedToScreen={vertical:"",horziontal:""}}open(t){this._closed&&(this.win.style.display="block",this._closed=!1,this.emit("open",this),t||this.focus())}focus(){this.active=!0,this.options.titlebar&&(this.winTitlebar.style.backgroundColor=this.options.backgroundTitlebarActive),this.emit("focus",this)}blur(){this.active=!1,this.options.titlebar&&(this.winTitlebar.style.backgroundColor=this.options.backgroundTitlebarInactive),this.emit("blur",this)}close(){this._closed||(this._closed=!0,this.win.style.display="none",this.emit("close",this))}get closed(){return this._closed}get x(){return this.options.x}set x(t){t!==this.options.x&&(this.options.x=t,this.emit("move-x",this),this._buildTransform())}_buildTransform(){this.win.style.transform=`translate(${this.options.x}px,${this.options.y}px)`}get y(){return this.options.y}set y(t){t!==this.options.y&&(this.options.y=t,this._buildTransform(),this.emit("move-y",this))}get width(){return this.options.width||this.win.offsetWidth}set width(t){t!==this.options.width&&(t?(this.win.style.width=t+"px",this.options.width=this.win.offsetWidth):(this.win.style.width="auto",this.options.width=""),this.emit("resize-width",this))}get height(){return this.options.height||this.win.offsetHeight}set height(t){t!==this.options.height&&(t?(this.win.style.height=t+"px",this.options.height=this.win.offsetHeight):(this.win.style.height="auto",this.options.height=""),this.emit("resize-height",this))}resize(t,e){this.width=t,this.height=e}move(t,e){const i=this.keepInside;if(i){if(!0===i||"horizontal"===i){const e=this.wm.win.offsetWidth;t=(t=t+this.width>e?e-this.width:t)<0?0:t}if(!0===i||"vertical"===i){const t=this.wm.win.offsetHeight;e=e+this.height>t?t-this.height:e;const i=m.getApplicationHeight();e=e<i?i:e}}t!==this.options.x&&(this.options.x=t,this.emit("move-x",this)),e!==this.options.y&&(this.options.y=e,this.emit("move-y",this)),this._buildTransform()}maximize(){if(this.options.maximizable)if(this.maximized)this.x=this.maximized.x,this.y=this.maximized.y,this.width=this.maximized.width,this.height=this.maximized.height,this.maximized=null,this.emit("restore",this),this.buttons.maximize.innerHTML=this.options.maximizeButton;else{const t=this.x,e=this.y,i=this.win.offsetWidth,s=this.win.offsetHeight;this.maximized={x:t,y:e,width:i,height:s},this.x=0,this.y=0,this.width=this.wm.wallpaper.offsetWidth,this.height=this.wm.wallpaper.offsetHeight,this.emit("maximize",this),this.buttons.maximize.innerHTML=this.options.restoreButton}}sendToBack(){this.wm.sendToBack(this)}sendToFront(){this.wm.sendToFront(this)}save(){const t={},e=this.maximized;return e&&(t.maximized={left:e.left,top:e.top,width:e.width,height:e.height}),t.x=this.x,t.y=this.y,void 0!==this.options.width&&(t.width=this.options.width),void 0!==this.options.height&&(t.height=this.options.height),t.closed=this._closed,t}load(t){t.maximized?this.maximized||this.maximize(!0):this.maximized&&this.maximize(!0),this.move(t.x,t.y),void 0!==t.width?this.width=t.width:this.win.style.width="auto",void 0!==t.height?this.height=t.height:this.win.style.height="auto",t.closed?this.close(!0):this.closed&&this.open(!0,!0)}get title(){return this._title}set title(t){this.winTitle.innerText=t,this.emit("title-change",this)}get right(){return this.x+this.width}set right(t){this.x=t-this.width}get bottom(){return this.y+this.height}set bottom(t){this.y=t-this.height}center(t){t?this.move(t.x+t.width/2-this.width/2,t.y+t.height/2-this.height/2):this.move(window.innerWidth/2-this.width/2,window.innerHeight/2-this.height/2)}_createWin(){this.win=r({parent:this.wm.win,styles:{display:"none","border-radius":this.options.borderRadius,"user-select":"none",overflow:"hidden",position:"absolute","min-width":this.options.minWidth,"min-height":this.options.minHeight,"background-color":this.options.backgroundWindow,width:isNaN(this.options.width)?this.options.width:this.options.width+"px",height:isNaN(this.options.height)?this.options.height:this.options.height+"px",...this.options.styles}})}_createWinBox(){this.winBox=r({parent:this.win,styles:{display:"flex","flex-direction":"column",width:"100%",height:"100%","min-height":this.options.minHeight}})}_createContent(){this.content=r({parent:this.winBox,type:"section",styles:{display:"block",flex:1,"min-height":this.options.minHeight,"overflow-x":"hidden","overflow-y":"auto"}})}_createOverlay(){this.overlay=r({parent:this.win,styles:{display:"none",position:"absolute",left:0,top:0,width:"100%",height:"100%"}}),this.overlay.addEventListener("mousedown",t=>{this._downTitlebar(t),t.stopPropagation()}),this.overlay.addEventListener("touchstart",t=>{this._downTitlebar(t),t.stopPropagation()})}_downTitlebar(t){const e=this._convertMoveEvent(t);this._moving={x:e.pageX-this.x,y:e.pageY-this.y},this.emit("move-start",this),this._moved=!1}_createTitlebar(){if(this.options.titlebar){this.winTitlebar=r({parent:this.winBox,type:"header",styles:{"user-select":"none",display:"flex","flex-direction":"row","align-items":"center","justify-content":"center",height:this.options.titlebarHeight,"min-height":this.options.titlebarHeight,border:0,padding:"0 8px",overflow:"hidden"}});const t={"user-select":"none",flex:1,display:"flex","flex-direction":"row","align-items":"center","user-select":"none",cursor:"default",padding:0,margin:0,"font-size":"16px","font-weight":400,color:this.options.foregroundTitle};this.options.titleCenter?t["justify-content"]="center":t["padding-left"]="8px",this.winTitle=r({parent:this.winTitlebar,type:"span",html:this.options.title,styles:t}),this._createButtons(),this.options.movable&&(this.winTitlebar.addEventListener("mousedown",t=>this._downTitlebar(t)),this.winTitlebar.addEventListener("touchstart",t=>this._downTitlebar(t))),this.options.maximizable&&c(this.winTitlebar,()=>this.maximize(),{doubleClicked:!0,clicked:!1})}}_createButtons(){this.winButtonGroup=r({parent:this.winTitlebar,styles:{display:"flex","flex-direction":"row","align-items":"center","padding-left":"10px"}});const t={display:"inline-block",border:0,margin:0,"margin-left":"15px",padding:0,width:"12px",height:"12px","background-color":"transparent","background-size":"cover","background-repeat":"no-repeat",opacity:.7,color:this.options.foregroundButton,outline:0};this.buttons={},this.options.maximizable&&(this.buttons.maximize=r({parent:this.winButtonGroup,html:this.options.maximizeButton,type:"button",styles:t}),c(this.buttons.maximize,()=>this.maximize())),this.options.closable&&(this.buttons.close=r({parent:this.winButtonGroup,html:this.options.closeButton,type:"button",styles:t}),c(this.buttons.close,()=>this.close()));for(let t in this.buttons){const e=this.buttons[t];e.addEventListener("mousemove",()=>{e.style.opacity=1}),e.addEventListener("mouseout",()=>{e.style.opacity=.7})}}_createResize(){this.resizeEdge=r({parent:this.winBox,type:"button",html:this.options.backgroundResize,styles:{position:"absolute",bottom:0,right:"4px",border:0,margin:0,padding:0,cursor:"se-resize","user-select":"none",height:"15px",width:"10px",background:"none"}});const t=t=>{const e=this._convertMoveEvent(t),i=this.width||this.win.offsetWidth,s=this.height||this.win.offsetHeight;this._resizing={width:i-e.pageX,height:s-e.pageY},this.emit("resize-start"),t.preventDefault()};this.resizeEdge.addEventListener("mousedown",t),this.resizeEdge.addEventListener("touchstart",t)}_move(t){const e=this._convertMoveEvent(t);this._isTouchEvent(t)||1===t.which||(this._moving&&this._stopMove(),this._resizing&&this._stopResize()),this._moving&&(this.move(e.pageX-this._moving.x,e.pageY-this._moving.y),this.emit("move",this),t.preventDefault()),this._resizing&&(this.resize(e.pageX+this._resizing.width,e.pageY+this._resizing.height),this.maximized=null,this.emit("resize",this),t.preventDefault())}_up(){this._moving&&this._stopMove(),this._resizing&&this._stopResize()}_listeners(){this.win.addEventListener("mousedown",()=>this.focus()),this.win.addEventListener("touchstart",()=>this.focus())}_stopMove(){this._moving=null,this.emit("move-end",this)}_stopResize(){this._restore=this._resizing=null,this.emit("resize-end",this)}_isTouchEvent(t){return!!window.TouchEvent&&t instanceof window.TouchEvent}_convertMoveEvent(t){return this._isTouchEvent(t)?t.changedTouches[0]:t}attachToScreen(t,e){this._attachedToScreen[t]=e}reposition(t,e){this.bounds=t,this.keepInside=e;let i=this.x,s=this.y;i="right"===this._attachedToScreen.horziontal?t.right-this.width:i,i="left"===this._attachedToScreen.horizontal?t.left:i,s="bottom"===this._attachedToScreen.vertical?t.bottom-this.height:s,s="top"===this._attachedToScreen.vertical?t.top:s,this.move(i,s)}isModal(t){return(t||!this._closed)&&this.options.modal}isClosed(){return this._closed}get z(){return parseInt(this.win.style.zIndex)}set z(t){this.win.style.zIndex=t}}g.id=0;const w={x:0,y:0,width:void 0,height:void 0,modal:!1,openOnCreate:!0,id:null,minWidth:"200px",minHeight:"60px",borderRadius:0,styles:{},movable:!0,resizable:!0,maximizable:!0,closable:!0,noSnap:!1,noMenu:!1,titlebar:!0,titlebarHeight:"2rem",backgroundWindow:"#fefefe",backgroundTitlebarActive:"#365d98",backgroundTitlebarInactive:"#888888",foregroundButton:"#ffffff",foregroundTitle:"#ffffff",closeButton:'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg width="100%" height="100%" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;"><rect id="close" x="0" y="0" width="20" height="20" style="fill:none;"/><g><path d="M3.5,3.5l13,13" style="fill:none;stroke:#fff;stroke-width:3px;"/><path d="M16.5,3.5l-13,13" style="fill:none;stroke:#fff;stroke-width:3px;"/></g></svg>',maximizeButton:'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg width="100%" height="100%" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;"><rect id="maximize" x="0" y="0" width="20" height="20" style="fill:none;"/><rect x="2" y="2" width="16" height="16" style="fill:none;stroke:#fff;stroke-width:2px;"/><rect x="2" y="2" width="16" height="3.2" style="fill:#fff;"/></svg>',restoreButton:'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg width="100%" height="100%" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;"><rect id="restore" x="0" y="0" width="20" height="20" style="fill:none;"/><g><rect x="7" y="2.5" width="10" height="10" style="fill:none;stroke:#fff;stroke-width:1.5px;"/><rect x="7" y="2.5" width="10" height="2" style="fill:#fff;"/></g><g><rect x="3" y="7.5" width="10" height="10" style="fill:none;stroke:#fff;stroke-width:1.5px;"/><g><rect x="3" y="7.5" width="10" height="2" style="fill:#fff;"/></g></g></svg>',backgroundResize:'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg width="100%" height="100%" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><rect id="resize" x="0" y="0" width="20" height="20" style="fill:none;"/><clipPath id="_clip1"><rect x="0" y="0" width="20" height="20"/></clipPath><g clip-path="url(#_clip1)"><rect x="0" y="16.8" width="20" height="3.2" style="fill:#fff;"/><path d="M17.737,3.595l-14.142,14.142l2.263,2.263l14.142,-14.142l-2.263,-2.263Z" style="fill:#fff;"/><path d="M16.8,0l0,20l3.2,0l0,-20l-3.2,0Z" style="fill:#fff;"/><path d="M7.099,18.4l11.301,-11.123l0,11.123l-11.301,0Z" style="fill:#fff;"/></g></svg>'},v={quiet:!1,keepInside:!0,snap:!0,noAccelerator:!1,menu:!1,styles:{},backgroundModal:"rgba(0, 0, 0, 0.6)"},b={screen:!0,windows:!0,snap:20,color:"#a8f0f4",spacing:0,indicator:10};class y{constructor(t,e={}){this.wm=t,this.options={...b,...e},this.highlights=r({parent:this.wm.wallpaper,styles:{position:"absolute"}}),this.horizontal=r({parent:this.highlights,styles:{display:"none",position:"absolute",height:this.options.indicator+"px",borderRadius:this.options.indicator+"px",backgroundColor:this.options.color}}),this.vertical=r({parent:this.highlights,styles:{display:"none",position:"absolute",width:this.options.indicator+"px",borderRadius:this.options.indicator+"px",backgroundColor:this.options.color}}),this.horizontal,this.showing=[]}stop(){this.highlights.remove(),this.stopped=!0}addWindow(t){t.on("move",()=>this.move(t)),t.on("move-end",()=>this.moveEnd(t))}screenMove(t,e,i){const s=m.getApplicationHeight(),n=this.wm.win.clientWidth,o=this.wm.win.clientHeight;t.left-this.options.snap<=n&&t.right+this.options.snap>=0&&(Math.abs(t.top-s)<=this.options.snap?e.push({distance:Math.abs(t.top-s),left:0,width:n,top:s,side:"top",screen:!0}):Math.abs(t.bottom-o)<=this.options.snap&&e.push({distance:Math.abs(t.bottom-o),left:0,width:n,top:o,side:"bottom",screen:!0})),t.top-this.options.snap<=o&&t.bottom+this.options.snap>=0&&(Math.abs(t.left-0)<=this.options.snap?i.push({distance:Math.abs(t.left-0),top:0,height:o,left:0,side:"left",screen:!0}):Math.abs(t.right-n)<=this.options.snap&&i.push({distance:Math.abs(t.right-n),top:0,height:o,left:n,side:"right",screen:!0}))}windowsMove(t,e,i,s){for(let n of this.wm.windows)if(!n.options.noSnap&&n!==t){const t=n.win.getBoundingClientRect();e.left-this.options.snap<=t.right&&e.right+this.options.snap>=t.left&&(Math.abs(e.top-t.bottom)<=this.options.snap?(i.push({distance:Math.abs(e.top-t.bottom),left:t.left,width:t.width,top:t.bottom,side:"top"}),Math.abs(e.left-t.left)<=this.options.snap?s.push({distance:Math.abs(e.left-t.left),top:t.top,height:t.height,left:t.left,side:"left",noSpacing:!0}):Math.abs(e.right-t.right)<=this.options.snap&&s.push({distance:Math.abs(e.right-t.right),top:t.top,height:t.height,left:t.right,side:"right",noSpacing:!0})):Math.abs(e.bottom-t.top)<=this.options.snap&&(i.push({distance:Math.abs(e.bottom-t.top),left:t.left,width:t.width,top:t.top,side:"bottom"}),Math.abs(e.left-t.left)<=this.options.snap?s.push({distance:Math.abs(e.left-t.left),top:t.top,height:t.height,left:t.left,side:"left",noSpacing:!0}):Math.abs(e.right-t.right)<=this.options.snap&&s.push({distance:Math.abs(e.right-t.right),top:t.top,height:t.height,left:t.right,side:"right",noSpacing:!0}))),e.top-this.options.snap<=t.bottom&&e.bottom+this.options.snap>=t.top&&(Math.abs(e.left-t.right)<=this.options.snap?(s.push({distance:Math.abs(e.left-t.right),top:t.top,height:t.height,left:t.right,side:"left"}),Math.abs(e.top-t.top)<=this.options.snap?i.push({distance:Math.abs(e.top-t.top),left:t.left,width:t.width,top:t.top,side:"top",noSpacing:!0}):Math.abs(e.bottom-t.bottom)<=this.options.snap&&i.push({distance:Math.abs(e.bottom-t.bottom),left:t.left,width:t.width,top:t.bottom,side:"bottom",noSpacing:!0})):Math.abs(e.right-t.left)<=this.options.snap&&(s.push({distance:Math.abs(e.right-t.left),top:t.top,height:t.height,left:t.left,side:"right"}),Math.abs(e.top-t.top)<=this.options.snap?i.push({distance:Math.abs(e.top-t.top),left:t.left,width:t.width,top:t.top,side:"top",noSpacing:!0}):Math.abs(e.bottom-t.bottom)<=this.options.snap&&i.push({distance:Math.abs(e.bottom-t.bottom),left:t.left,width:t.width,top:t.bottom,side:"bottom",noSpacing:!0})))}}move(t){if(this.stopped||t.options.noSnap||t.isModal())return;this.horizontal.style.display="none",this.vertical.style.display="none";const e=[],i=[],s=t.win.getBoundingClientRect();if(this.options.screen&&this.screenMove(s,e,i),this.options.windows&&this.windowsMove(t,s,e,i),e.length){e.sort((t,e)=>t.distance-e.distance);const t=e[0];this.horizontal.style.display="block",this.horizontal.style.width=t.width+"px",this.horizontal.y=t.top-this.options.indicator/2,this.horizontal.yPosition=t.top,this.horizontal.style.transform=`translate(${t.left}px,${this.horizontal.y}px)`,this.horizontal.side=t.side,this.horizontal.noSpacing=t.noSpacing,this.horizontal.screen=t.screen}if(i.length){i.sort((t,e)=>t.distance-e.distance);const t=i[0];this.vertical.style.display="block",this.vertical.style.height=t.height+"px",this.vertical.x=t.left-this.options.indicator/2,this.vertical.xPosition=t.left,this.vertical.style.transform=`translate(${this.vertical.x}px,${t.top}px)`,this.vertical.side=t.side,this.vertical.noSpacing=t.noSpacing,this.vertical.screen=t.screen}}moveEnd(t){if(this.stopped)return;const e=this.wm.bounds,i=m.getApplicationHeight();if("block"===this.horizontal.style.display){const s=this.horizontal.noSpacing?0:this.options.spacing;switch(this.horizontal.side){case"top":t.y=this.horizontal.yPosition+s-e.top+i;break;case"bottom":t.bottom=Math.floor(this.horizontal.yPosition-s-e.top+i)}t.attachToScreen("vertical",this.horizontal.screen?this.horizontal.side:"")}if("block"===this.vertical.style.display){const i=this.vertical.noSpacing?0:this.options.spacing;switch(this.vertical.side){case"left":t.x=this.vertical.xPosition+i-e.left;break;case"right":t.right=Math.floor(this.vertical.xPosition-i-e.left)}t.attachToScreen("horziontal",this.vertical.screen?this.vertical.side:"")}this.horizontal.style.display=this.vertical.style.display="none"}}class x{constructor(t={},e={}){this.options={...v,...t},this.options.parent=this.options.parent||document.body,this.options.quiet||console.log("%c  simple-window-manager initialized ","color: #ff00ff"),this.windows=[],this.active=null,this._setupWin(),this._setupWallpaper(),this._setupModal(),this.options.snap&&this.snap(!0===this.options.snap?{}:this.options.snap),this.windowOptions={...w,...e},window.addEventListener("resize",()=>this.resize()),this.options.noAccelerator||u.init()}createWindow(t={}){const e=new g(this,{...this.windowOptions,...t});return e.on("open",()=>this._open(e)),e.on("focus",()=>this._focus(e)),e.on("blur",()=>this._blur(e)),e.on("close",()=>this._close(e)),e.win.addEventListener("mousemove",t=>this._move(t)),e.win.addEventListener("touchmove",t=>this._move(t)),e.win.addEventListener("mouseup",t=>this._up(t)),e.win.addEventListener("touchend",t=>this._up(t)),this._snap&&!t.noSnap&&this._snap.addWindow(e),e.reposition(this.bounds,this.options.keepInside),e.options.openOnCreate&&e.open(),e}snap(t){this._snap=new y(this,t);for(const t of this.windows)t.options.noSnap||this._snap.addWindow(t)}sendToFront(t){const e=this.windows.indexOf(t);console.assert(-1!==e,"sendToFront should find window in this.windows"),e!==this.windows.length-1&&(this.windows.splice(e,1),this.windows.push(t),this._reorder())}sendToBack(t){const e=this.windows.indexOf(t);console.assert(-1!==e,"sendToFront should find window in this.windows"),0!==e&&(this.windows.splice(e,1),this.windows.unshift(t),this._reorder())}save(){const t={};for(let e=0;e<this.windows.length;e++){const i=this.windows[e];t[i.id]=i.save(),t[i.id].order=e}return t}load(t){for(const e in t){const i=this.getWindowById(e);i&&i.load(t[e])}}closeAll(){for(let t of this.windows)t.close();this.windows=[],this.active=null}_reorder(){let t=0;for(const e of this.windows)e.isClosed()||(e.z=t++)}_setupWin(){this.win=r({parent:this.options.parent,styles:{"user-select":"none",width:"100%",height:"100%",overflow:"hidden","z-index":-1,cursor:"default",...this.options.styles}})}_setupWallpaper(){this.wallpaper=r({parent:this.win,styles:{"user-select":"none",position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden"}}),this.wallpaper.addEventListener("mousemove",t=>this._move(t)),this.wallpaper.addEventListener("touchmove",t=>this._move(t)),this.wallpaper.addEventListener("mouseup",t=>this._up(t)),this.wallpaper.addEventListener("touchend",t=>this._up(t))}_setupModal(){this.modalOverlay=r({parent:this.win,styles:{display:"none","user-select":"none",position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden",background:this.options.backgroundModal}}),this.modalOverlay.addEventListener("mousemove",t=>{this._move(t),t.preventDefault(),t.stopPropagation()}),this.modalOverlay.addEventListener("touchmove",t=>{this._move(t),t.preventDefault(),t.stopPropagation()}),this.modalOverlay.addEventListener("mouseup",t=>{this._up(t),t.preventDefault(),t.stopPropagation()}),this.modalOverlay.addEventListener("touchend",t=>{this._up(t),t.preventDefault(),t.stopPropagation()}),this.modalOverlay.addEventListener("mousedown",t=>{t.preventDefault(),t.stopPropagation()}),this.modalOverlay.addEventListener("touchstart",t=>{t.preventDefault(),t.stopPropagation()})}_open(t){this.windows.push(t),this._reorder(),t.options.modal?(this.modalOverlay.style.display="block",this.modalOverlay.style.zIndex=t.z):this.modalOverlay.style.display="none"}_focus(t){if(this.active===t)return;this.active&&this.active.blur();const e=this.windows.indexOf(t);console.assert(-1!==e,"WindowManager._focus should find window in this.windows"),e!==this.windows.length-1&&(this.windows.splice(e,1),this.windows.push(t)),this._reorder(),this.active=this.windows[this.windows.length-1]}_blur(t){this.active===t&&(this.active=null)}_close(t){t.isModal(!0)&&(next&&next.isModal()?this.modalOverlay.style.zIndex=next.z:this.modalOverlay.style.display="none")}_move(t){for(const e in this.windows)this.windows[e]._move(t)}_up(t){for(const e in this.windows)this.windows[e]._up(t)}checkModal(t){return!this.modal||this.modal===t}get bounds(){const t=m.getApplicationHeight();return{top:this.win.offsetTop+t,bottom:this.win.offsetTop+this.win.offsetHeight,left:this.win.offsetLeft,right:this.win.offsetLeft+this.win.offsetWidth}}resize(){const t=this.bounds;for(const e in this.windows)this.windows[e].reposition(t,this.options.keepInside)}getWindowById(t){return this.windows.find(e=>e.id===t)}}let _,k;window.onload=()=>{k=new x({snap:{screen:!0,windows:!0}}),function(t){const e=new m;e.append(new f({label:"&New Window",accelerator:"ctrl+m",click:()=>{}})),_=new m;const i=new m;i.append(new f({label:"simple-&window-manager",click:()=>{}})),i.append(new f({label:"yy-menu",click:()=>{}}));const s=new m;s.append(new f({label:"&File",submenu:e})),s.append(new f({label:"&Windows",submenu:_})),s.append(new f({label:"&About",submenu:i})),m.setApplicationMenu(s)}(),function(){const t=k.createWindow({x:10,y:10,titlebar:!1,title:"Test Window",resizable:!1,maximizable:!1,minimizable:!1,titleCenter:!0,closable:!1});t.content.style.padding="1em",t.content.innerHTML="This is a test window.",t.open()}(),function(){const t=k.createWindow({width:300,height:150,x:100,y:100,titlebarHeight:"22px",backgroundTitlebarActive:"green",backgroundTitlebarInactive:"purple",backgroundWindow:"rgb(255,200,255)"});t.content.style.padding="0.5em",t.content.innerHTML="This is a pink test window.<br><br>Check out the fancy title bar for other style tests.<br><br><br>And scrolling!!!",t.open()}(),function(){const t=k.createWindow({x:300,y:400,width:350,title:"This is one fancy demo!"});t.content.style.padding="1em",r({parent:t.content,html:"OK. It isn't that fancy, but it shows off some of the functionality of this library.<br><br>Please excuse the mess. I do NOT keep my desktop this messy, but I thought it made for a good demo."});const e=r({parent:t.content,styles:{textAlign:"center",marginTop:"1em"}}),i=r({parent:e,type:"button",html:"open modal window"});let s=0,n=0;i.onclick=()=>function e(){const i=k.createWindow({modal:!0,width:200,title:"modal window",minimizable:!1,maximizable:!1}),o=r({parent:i.content,styles:{margin:"0.5em"}});r({parent:o,html:"This needs to be closed before using other windows."});const h=r({parent:o,styles:{"text-align":"center",margin:"1em",display:"flex"}}),a=r({parent:h,type:"button",html:"open child modal"});r({parent:h,type:"button",html:"close modal"}).onclick=()=>i.close(),a.onclick=()=>e(),i.open(),i.center(t),i.move(i.x+s,i.y+n),s+=20,n+=20}(),t.open()}(),function(){const t=k.createWindow({x:300,y:10,title:"My wife's art gallery!",maximizable:!1});t.content.innerHTML='<iframe width="560" height="315" src="https://yuanru.gallery" frameborder="0" allow="encrypted-media" allowfullscreen></iframe>',t.open(),t.sendToBack()}(),function(){const t=k.createWindow({x:20,y:600,title:"window save/load"});r({parent:t.content,html:"Save the windows, and then move windows around and load them.",styles:{margin:"0.5em"}});const e=r({parent:t.content,styles:{"text-align":"center"}}),i=r({parent:e,html:"save window state",type:"button",styles:{margin:"1em",background:"rgb(200,255,200)"}}),s=r({parent:e,html:"load window state",type:"button",styles:{margin:"1em",background:"rgb(255,200,200)"}});let n;t.open(),i.onclick=()=>n=k.save(),s.onclick=()=>{n&&k.load(n)}}(),function(){const t=k.createWindow({x:700,y:40,width:400,height:300,title:"API documentation",styles:{overflow:"hidden"}});t.content.innerHTML='<iframe width="100%" height="100%" src="https://davidfig.github.io/window-manager/jsdoc/"></iframe>',t.open()}(),r({parent:k.wallpaper,styles:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"white"}}).innerHTML="You can also use the background as wallpaper or another window surface.",function(t){for(let e=0;e<t.windows.length;e++){const i=t.windows[e];_.append(new f({type:"checkbox",label:i.options.title||"Window "+(e<10?"&":"")+e,accelerator:e<10?"ctrl+"+e:null,checked:!0,click:(i,s)=>{s.checked?t.windows[e].open():t.windows[e].close()}}))}}(k),S()};const C=new h;function S(){C.frame(!1,!0),requestAnimationFrame(S)}}();
//# sourceMappingURL=index.js.map
